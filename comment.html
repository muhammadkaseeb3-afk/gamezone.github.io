<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Professional Comments System</title>

<style>
body{font-family: 'Segoe UI', Arial, sans-serif; background:#f0f2f5; color: #1c1e21;}
.container{width:720px; margin:30px auto; background:#fff; padding:20px; border-radius:8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);}
h2{font-size: 20px; border-bottom: 1px solid #ddd; padding-bottom: 10px;}

/* Input Area */
.add-comment{ display:flex; gap:10px; margin-bottom:15px; align-items:flex-start;}
textarea, input[type=text]{
  padding:12px; border:1px solid #ddd; border-radius:20px;
  background: #f0f2f5; font-size:14px; outline: none; box-sizing:border-box;
}
#nameInput{width:180px;}
#commentInput{flex:1; height: 44px;}
button{
  padding:0 20px; cursor:pointer; height:40px; background: #0084ff; 
  color: #fff; border: none; border-radius: 20px; font-weight: bold;
}
button:hover{background: #0073e6;}

/* File Upload Styling */
.file-label { font-size: 13px; color: #65676b; margin-left: 10px; cursor: pointer; display: block; margin-bottom: 15px;}
.file-label:hover { text-decoration: underline; color: #0084ff; }

/* Avatar Styling */
.avatar{
  width:40px; height:40px; border-radius:50%; overflow:hidden;
  display: flex; align-items: center; justify-content: center;
  color: white; font-weight: bold; font-size: 18px; text-transform: uppercase;
  flex-shrink: 0; background: #ccc;
}
.avatar img{width:100%; height:100%; object-fit:cover}

/* Comments List */
.comment{display:flex; margin-top:20px; gap: 12px;}
.comment-content { background: #f0f2f5; padding: 10px 15px; border-radius: 18px; position: relative; max-width: 85%; }
.header{font-weight:bold; font-size:13px;}
.header span{color:#65676b; font-weight: normal; font-size:11px; margin-left:8px}
.text-body { font-size: 14px; margin-top: 4px; line-height: 1.4; }

.actions { margin-left: 52px; margin-top: 4px; display: flex; gap: 15px; }
.actions span { cursor:pointer; font-size:12px; color:#65676b; font-weight: bold; }
.actions span:hover { text-decoration: underline; }
.delete-btn { color: #f02849 !important; }

/* Reply Box */
.reply-box{ display:none; margin-left:52px; margin-top:10px; }
.reply-box input, .reply-box textarea { border-radius: 12px; margin-bottom: 5px; width: 100%; display: block; }
.reply { margin-left: 52px; margin-top: 15px; display: flex; gap: 10px; align-items: flex-start; }

/* Popup */
#popup{
  display:none; position:fixed; top:50%; left:50%; transform:translate(-50%,-50%);
  background:#fff; padding:20px; border-radius:8px; box-shadow:0 10px 25px rgba(0,0,0,0.2);
  z-index:1000; text-align:center; min-width: 250px;
}
</style>
</head>

<body>
<div class="container">
<h2 id="count">0 Comments</h2>

<div id="popup">
  <p id="popupMessage" style="margin-bottom: 15px;"></p>
  <button onclick="closePopup()">OK</button>
</div>

<div class="add-comment">
  <input type="text" id="nameInput" placeholder="Your name">
  <textarea id="commentInput" placeholder="Write a comment..."></textarea>
  <button onclick="addComment()">Post</button>
</div>
Optional:  
<label class="file-label">
  <h2>Upload Photo</h2>
  <input type="file" id="photoInput" accept="image/*" style="display:none">
</label>

<div id="commentsDiv"></div>
</div>

<script>
let comments = JSON.parse(localStorage.getItem("myComments")) || [];

function saveData() { localStorage.setItem("myComments", JSON.stringify(comments)); }

function getRandomColor() {
  const colors = ['#f44336', '#e91e63', '#9c27b0', '#673ab7', '#3f51b5', '#2196f3', '#009688', '#4caf50', '#ff9800', '#ff5722'];
  return colors[Math.floor(Math.random() * colors.length)];
}

function showPopup(msg) { document.getElementById("popupMessage").innerText = msg; document.getElementById("popup").style.display="block"; }
function closePopup() { document.getElementById("popup").style.display="none"; }

async function getBase64(file) {
  return new Promise((res) => {
    const reader = new FileReader();
    reader.readAsDataURL(file);
    reader.onload = () => res(reader.result);
  });
}

async function addComment(){
  const name = document.getElementById("nameInput").value.trim();
  const text = document.getElementById("commentInput").value.trim();
  const photo = document.getElementById("photoInput").files[0];

  if(!name || !text) return showPopup("Please enter name and comment!");

  let imgData = photo ? await getBase64(photo) : null;

  comments.unshift({
    name, text, img: imgData, color: getRandomColor(),
    time: Date.now(), likes: 0, replies: []
  });

  document.getElementById("nameInput").value="";
  document.getElementById("commentInput").value="";
  document.getElementById("photoInput").value="";
  saveData(); render();
}

function render(){
  document.getElementById("count").innerText = `${comments.length} Comments`;
  const div = document.getElementById("commentsDiv");
  div.innerHTML = "";

  comments.forEach((c, i) => {
    const timeStr = new Date(c.time).toLocaleDateString();
    div.innerHTML += `
      <div class="comment">
        <div class="avatar" style="background:${c.color}">${c.img ? `<img src="${c.img}">` : c.name[0]}</div>
        <div class="comment-content">
          <div class="header">${c.name} <span>${timeStr}</span></div>
          <div class="text-body">${c.text}</div>
        </div>
      </div>
      <div class="actions">
        <span onclick="like(${i})">Like (${c.likes})</span>
        <span onclick="toggleReply(${i})">Reply</span>
        <span class="delete-btn" onclick="del(${i})">Delete</span>
      </div>
      <div id="rBox${i}" class="reply-box">
        <input type="text" id="rName${i}" placeholder="Your name">
        <textarea id="rText${i}" placeholder="Write a reply..."></textarea>
        <button onclick="addReply(${i})">Reply</button>
      </div>
      ${c.replies.map(r => `
        <div class="reply">
          <div class="avatar" style="width:30px; height:30px; font-size:14px; background:${r.color}">
            ${r.img ? `<img src="${r.img}">` : r.name[0]}
          </div>
          <div class="comment-content" style="background:#f0f2f5;">
            <div class="header" style="font-size:12px;">${r.name}</div>
            <div class="text-body" style="font-size:13px;">${r.text}</div>
          </div>
        </div>
      `).join('')}
    `;
  });
}

function like(i) { comments[i].likes++; saveData(); render(); }
function del(i) { if(confirm("Delete?")) { comments.splice(i,1); saveData(); render(); } }
function toggleReply(i) { const b = document.getElementById("rBox"+i); b.style.display = b.style.display==='block' ? 'none' : 'block'; }

async function addReply(i) {
  const n = document.getElementById("rName"+i).value;
  const t = document.getElementById("rText"+i).value;
  if(!n || !t) return showPopup("Fill both fields!");
  comments[i].replies.push({name:n, text:t, color:getRandomColor(), time:Date.now()});
  saveData(); render();
}

render();
</script>
</body>
</html>